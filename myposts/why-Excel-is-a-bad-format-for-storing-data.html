<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Andy Grogan-Kaylor" />
  <title>Why Excel Is A Bad Format For Storing Data</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<style>
/* CSS for Markstat 2.0 using Pandoc 2.0 */
body{padding:14px 28px; max-width:45em;}
body, table {font-family: Helvetica, Arial, Sans-serif; font-size: 14px;}
h1, h2, h3, h4 {font-weight: normal; color: #3366cc}
h1 {font-size: 200%;}
h2 {font-size: 150%;}
h3 {font-size: 120%;}
h4 {font-size: 100%; font-weight:bold}
img.center {display:block; margin-left:auto; margin-right:auto}
.small{font-size:8pt;}
a {color: black;}
a:visited {color: #808080;}
a.plain {text-decoration:none;}
a.plain:hover {text-decoration:underline;}
.em {font-weight:bold;}
pre, code {font-family: "lucida console", monospace;}
pre.stata {font-size:13px; line-height:13px;}
pre {padding:8px; border:1px solid #c0c0c0; border-radius:8px; background-color:#fdfdfd;}
code {color:#3366cc; background-color:#fafafa;}
pre code { color:black; background-color:white}
/* Added for Pandoc */
figure > img, div.figure > img {display:block; margin:auto}
figcaption, p.caption {text-align:center; font-weight:bold; color:#3366cc;}
h1.title {text-align:center; margin-bottom:0}
p.author, h2.author {font-style:italic; text-align:center;margin-top:4px;margin-bottom:0}
p.date, h3.date {text-align:center;margin-top:4px; margin-bottom:0}
/* Tables*/
table { margin:auto; border-collapse:collapse; }
table caption { margin-bottom:1ex;}
td {padding:0 0 0 0} /* override */
table:not([class]) th { padding:4px 6px } 
table:not([class]) td { padding:4px 6px } 
table:not([class]) thead tr:first-child th {border-top:1px solid black; padding-top:6px}
table:not([class]) thead tr:last-child  th {padding-bottom:6px}
table:not([class]) tbody tr:first-child td {border-top:1px solid black; padding-top:6px}
table:not([class]) tbody tr:last-child  td {padding-bottom:6px;}
table:not([class]) tbody:last-child tr:last-child td {border-bottom:1px solid black;}
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Why Excel Is A Bad Format For Storing Data</h1>
<p class="author">Andy Grogan-Kaylor</p>
<p class="date">31 Mar 2023 11:17:17</p>
</header>
<style>body {max-width: 90%;} h1 {color: #00274C;} h2 {color: #2F65A7;} blockquote {border-left: 5px solid #ffcb05; margin: 1.5em 10px; padding: 0.5em 10px;} a:link {color: #00274C;} a:visited {color: #2F65A7;} code {color: red;}</style>
<h1 id="background">Background</h1>
<p>Excel is sometimes used as a program to collect and store data.
However, Excel may be problematic as a data storage solution for a
number of reasons detailed below. Notably, statistical programs like <a
href="https://www.stata.com/">Stata</a>, <a
href="https://www.sas.com/en_us/home.html">SAS</a>, or SPSS all store
additional information with each variable such as: a <em>variable
label</em>, describing the contents of the variable, or the survey
question that resulted in the variable; and a <em>value label</em>,
which attaches qualitative information to each possible value of the
response.</p>
<p>Excel does not generally contain this extra information about each
variable, or column of data, which may lead to errors in working with
quantitative information.</p>
<p>The data below are stored in Stata format, but could as easily be
stored in SAS or SPSS format.</p>

<h1 id="get-the-data">Get The Data</h1>
<pre class='stata'>. use "simulated-happiness-data.dta", clear
</pre>
<figure>
<img
src="./why-Excel-is-a-bad-format-for-storing-data/screenshot-Stata.png"
style="width:50.0%" alt="Screenshot of Stata" />
<figcaption aria-hidden="true">Screenshot of Stata</figcaption>
</figure>
<h1 id="describe-the-data">Describe The Data</h1>
<pre class='stata'>. describe

Contains data from simulated-happiness-data.dta
 Observations:           100                  
    Variables:             2                  31 Mar 2023 11:17
──────────────────────────────────────────────────────────────────────────────────────────
Variable      Storage   Display    Value
    name         type    format    label      Variable label
──────────────────────────────────────────────────────────────────────────────────────────
id              float   %9.0g                 id
Q1              float   %9.0g      Likert1    How often do you feel happy?
──────────────────────────────────────────────────────────────────────────────────────────
Sorted by: 
</pre>
<h1 id="descriptive-statistics-and-bar-graph">Descriptive Statistics and
Bar Graph</h1>
<blockquote>
<p>Notice how the descriptive statistics and graph are informative in
that they contain information on the <em>variable label</em> and
<em>value label</em>. These help us to get an intuitive sense of the
information in the data. We see this information when we list out the
data as well.</p>
</blockquote>
<h2 id="descriptive-statistics">Descriptive Statistics</h2>
<pre class='stata'>. tabulate Q1

  How often │
do you feel │
     happy? │      Freq.     Percent        Cum.
────────────┼───────────────────────────────────
      Never │         21       21.00       21.00
     Rarely │         29       29.00       50.00
  Sometimes │         28       28.00       78.00
      Often │         22       22.00      100.00
────────────┼───────────────────────────────────
      Total │        100      100.00
</pre>
<h2 id="bar-graph">Bar Graph</h2>
<pre class='stata'>. graph bar, over(Q1) scheme(michigan2) asyvars

.     
. graph export mybar1.png, width(500) replace
file /Users/agrogan/Desktop/GitHub/agrogan1.github.io/myposts/mybar1.png saved as PNG
    format
</pre>
<figure>
<img src="mybar1.png" alt="Bar Graph" />
<figcaption aria-hidden="true">Bar Graph</figcaption>
</figure>
<h2 id="list-out-a-sample-of-the-data">List Out A Sample Of The
Data</h2>
<pre class='stata'>. list in 1/10

     ┌────────────────┐
     │ id          Q1 │
     ├────────────────┤
  1. │  1       Never │
  2. │  2   Sometimes │
  3. │  3       Never │
  4. │  4   Sometimes │
  5. │  5   Sometimes │
     ├────────────────┤
  6. │  6       Often │
  7. │  7      Rarely │
  8. │  8   Sometimes │
  9. │  9       Never │
 10. │ 10      Rarely │
     └────────────────┘
</pre>
<h1 id="now-use-the-data-in-excel-format">Now Use The Data In Excel
Format</h1>

<p>We’ve saved this simulated data in Excel format.</p>
<figure>
<img
src="./why-Excel-is-a-bad-format-for-storing-data/screenshot-Excel.png"
style="width:50.0%" alt="Screenshot of Excel" />
<figcaption aria-hidden="true">Screenshot of Excel</figcaption>
</figure>
<p>We now import the Excel data file. We use the first row of data as
variable names.</p>
<pre class='stata'>. import excel "simulated-happiness-data.xls", sheet("Sheet1") firstrow clear
(2 vars, 100 obs)
</pre>
<blockquote>
<p>We see right away–when we list some of the data–that the data are
less informative.</p>
</blockquote>
<pre class='stata'>. list in 1/10

     ┌─────────┐
     │ id   Q1 │
     ├─────────┤
  1. │  1    1 │
  2. │  2    3 │
  3. │  3    1 │
  4. │  4    3 │
  5. │  5    3 │
     ├─────────┤
  6. │  6    4 │
  7. │  7    2 │
  8. │  8    3 │
  9. │  9    1 │
 10. │ 10    2 │
     └─────────┘
</pre>
<blockquote>
<p>Adding this valuable information back into the data set may take a
great deal of extra effort.</p>
</blockquote>
<h1 id="descriptive-statistics-and-bar-graph-1">Descriptive Statistics
and Bar Graph</h1>
<blockquote>
<p>Notice how the descriptive statistics and graph are much less
informative. For example, it is now not immediately clear what
<code>Q1</code> represents.</p>
</blockquote>
<blockquote>
<p>It is also not clear whether higher values of <code>Q1</code>
represent higher levels of <em>happiness</em>, or higher levels of
<em>unhappiness</em>, a crucially important substantive distinction. The
information on variable label and value label will have to be added back
into the data when preparing a report for dissemination.</p>
</blockquote>
<h2 id="descriptive-statistics-1">Descriptive Statistics</h2>
<pre class='stata'>. tabulate Q1

         Q1 │      Freq.     Percent        Cum.
────────────┼───────────────────────────────────
          1 │         21       21.00       21.00
          2 │         29       29.00       50.00
          3 │         28       28.00       78.00
          4 │         22       22.00      100.00
────────────┼───────────────────────────────────
      Total │        100      100.00
</pre>
<h3 id="bar-graph-1">Bar Graph</h3>
<pre class='stata'>. graph bar, over(Q1) scheme(michigan2) asyvars

.     
. graph export mybar2.png, width(500) replace
file /Users/agrogan/Desktop/GitHub/agrogan1.github.io/myposts/mybar2.png saved as PNG
    format
</pre>
<figure>
<img src="mybar2.png" alt="Bar Graph" />
<figcaption aria-hidden="true">Bar Graph</figcaption>
</figure>
<h1 id="a-few-final-issues">A Few Final Issues</h1>
<p>Notice how Excel doesn’t enforce the idea of whether variables are
<em>numeric</em>, or <em>string</em>, and so would allow storage of
different types of information in the same column.</p>
<p>Secondly, Excel would allow some of your columns to have the same
name, which might make data difficult to work with in other
software.</p>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 33%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="header">
<th>x</th>
<th>y</th>
<th>verylongvariablename</th>
<th>verylongvariablename</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>100</td>
<td>1</td>
<td>Smith</td>
<td>20</td>
</tr>
<tr class="even">
<td>200</td>
<td>2</td>
<td>30</td>
<td>NA</td>
</tr>
<tr class="odd">
<td>not applicable</td>
<td>x</td>
<td>yes</td>
<td>60</td>
</tr>
</tbody>
</table>
</body>
</html>
