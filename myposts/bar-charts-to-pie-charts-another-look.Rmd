---
title: "Bar Charts to Pie Charts: Another Look"
author: "Andy Grogan-Kaylor"
date: "`r Sys.Date()`"
output:
  tint::tintPdf:
    number_sections: yes
    toc: yes
  tufte::tufte_handout:
    number_sections: yes
    toc: yes
    latex_engine: xelatex
  pdf_document: 
    fig_height: 3
    number_sections: yes
    toc: yes
  html_document: 
    fig_height: 3
    highlight: haddock
    number_sections: yes
    theme: default
    code_folding: hide 
    code_download: yes
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      fig.margin = TRUE)

```

<style>
h1, h2 {
  color: navy;
  font-family: "Helvetica", "Arial", sans-serif; 
  font-weight: normal;
}
.list-group-item.active, 
.list-group-item.active:focus, 
.list-group-item.active:hover {
    z-index: 2;
    color: gold;
    background-color: navy;
    border-color: blue;
}
.nav-pills > li.active > a, .nav-pills > li.active > a:focus {
    color: gold;
    background-color: navy;
}
.nav-pills > li.active > a:hover {
    color: gold;
    background-color: navy;

}
blockquote {
  background: #FFFFFF;
  color: #000;
  border-left: 5px solid #ffcb05;
  margin: 1.5em 10px;
  padding: 0.5em 10px;
}
</style>

# Background

A quick look at moving from bar charts to pie charts. 

A longer explanation of some issues is here: [https://agrogan1.github.io/myposts/bar_charts_in_ggplot2.html](https://agrogan1.github.io/myposts/bar_charts_in_ggplot2.html)

# Get Data

```{r}

load("social_service_agency.RData")

```

```{r, echo=FALSE}

library(dplyr)

clients <- clients %>% select(age, program, gender)

```

```{r, echo=FALSE}

library(pander)

pander(head(clients))

```

# Call `ggplot`

```{r}

library(ggplot2)

```

# One Dimension of Data (program)

## Bar Chart

```{r}

ggplot(clients, # data I am using
       aes(x = program, # x is program
           fill = program)) + # fill is also program
  geom_bar() # use bars

```

## Stacked Bar Chart

```{r}

ggplot(clients, # data I am using
       aes(x = 1, # x is now 1 for everyone
           fill = program)) + # fill is program
  geom_bar() # use bars

```

## Pie Chart

```{r}

ggplot(clients, # data I am using
       aes(x = 1, # x is now 1 for everyone
           fill = program)) + # fill is program
  geom_bar() + # use bars
  coord_polar(theta = "y") + # use polar coordinates
  theme_void() # blank theme for pie charts

```

# Two Dimensions of Data (program X gender)

## Stacked Bar Chart

```{r}

ggplot(clients, # data I am using
       aes(x = program, # x is back to program
           fill = gender)) + # fill is gender
  geom_bar() # use bars

```

## Unstack the Bars

```{r}

ggplot(clients, # data I am using
       aes(x = program, # x is back to program
           fill = gender)) + # fill is gender
  geom_bar(position = "dodge2") # unstack ('dodge') the bars

```

## Pie Chart

One approach ...

```{r}

# position = position_fill() makes the slices
# fill the pie in each facet

ggplot(clients, # data I am using
       aes(x = 1, # x is back to 1
           fill = gender)) + # fill is gender
  geom_bar(position = position_fill()) + # use bars
  coord_polar(theta = "y") + # polar coordinates
  facet_wrap(~program) + # facet wrap on program
  theme_void() # blank theme for pie charts

```
