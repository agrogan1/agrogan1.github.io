{
  "hash": "70801d0c9a402991272b0c8246d654eb",
  "result": {
    "markdown": "---\ntitle: \"Telling Stories With Data: Bar Charts and Pie Charts\"\nsubtitle: \"Conceptual Relationships Among Graphs, and the Grammar of Graphics\"\nauthor: \"Andy Grogan-Kaylor\"\ndate: \"2023-8-20\"\ncategories: [stats, dataviz]\n---\n\n\n# Background\n\nIn this document, I talk about **bar charts**, **stacked bar charts**, and **pie charts**.  I want to focus on the *conceptual relationships* between these kinds of graphs, using the idea of *grammar of graphics*. \n\n> These graphs were made in `ggplot2`. The code for each graph is provided, as it may be useful for some audiences, but the focus here is really on the relationships between these graphs, and the advantages and disadvantages of different graphing strategies in terms of *telling a story with the data*. Those not interested in the intricacies of `ggplot` may feel free to ignore the code. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# call necessary libraries\n\nlibrary(ggplot2) # beautiful graphs\n\nlibrary(pander) # nice tables\n\nlibrary(tibble) # new data frames\n\nlibrary(DiagrammeR) # digrams\n```\n:::\n\n\n# Some Data\n\nHere is what the beginning of the data looks like.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nN <- 100\n\ngroup <- sample(c(0:2), \n            N, \n            replace=TRUE, \n            prob=c(0.4, 0.4, 0.2)) \n\ngroup <- factor(group,\n                levels = c(0, 1, 2),\n                labels = c(\"Group A\", \"Group B\", \"Group C\"))\n\nmydata <- tibble::tibble(group)\n\npander(head(mydata, 10))\n```\n\n::: {.cell-output-display}\n---------\n  group  \n---------\n Group B \n\n Group A \n\n Group B \n\n Group B \n\n Group B \n\n Group B \n\n Group C \n\n Group A \n\n Group A \n\n Group B \n---------\n:::\n:::\n\n\n# A Simple Bar Chart\n\nWe start with a simple bar chart.\n\n::: {.callout-tip collapse=\"true\"}\nIf you are following the `ggplot` code, you will note that `ggplot` rapidly becomes very verbose. \n \nThe *essential detail* to focus on is the *aesthetic*, `aes`, which tells ggplot what *dimensions* of the data are being mapped on to what specific elements of the graph. The data we are using only has 1 *dimension*: of what group is each individual a member?\n\nMuch of the verbosity of `ggplot` comes from telling `ggplot` about the *labels*, *fill colors*, and *theme*.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(data = mydata,\n       aes(x = group, # x is the group\n           fill = group)) + # fill is also the group\n  geom_bar() + # draw with bars\n  labs(title = \"A Bar Chart\") + # labels\n  scale_fill_viridis_d() + # pretty colors\n  theme_minimal() # minimal theme\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Grammar of Graphics\n\nI'm going to rely on Wilkinson's idea of a *Grammar of Graphics*. Wilkinson talks about such a grammar being characterized by *has a* relationships which I have indicated here with $\\leftarrow$ symbols. \n\nSo, for example, this graph has an *x axis*, and a *y axis*, and *color*. \n\nThe *x axis* in this graph denotes *group*, as does the *color* of the graph. \n\nThe *y axis* represents the *count* of *group*.\n\nSo the grammar of this graph might look something like the following:\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"grViz html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-38d7098c83a8a84aa3b7\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-38d7098c83a8a84aa3b7\">{\"x\":{\"diagram\":\"\\n\\ndigraph {\\n\\ngraph [layout = dot,\\n       rankdir = RL]\\n\\n# node definitions with substituted label text\\nnode [fontname = Helvetica]\\n\\ng [label = \\\"graph\\\"]\\nx [label = \\\"x axis\\\"]\\ny [label = \\\"y axis\\\"]\\n\\n# edge definitions with the node IDs\\n\\nx -> g\\ny -> g\\ncolor -> g\\ncount -> y\\ngroup -> x\\ngroup -> color\\n\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Advantages and Disadvantages\n\n**Advantages:** Simplicity. Straightforwardness. Easy to compare the height of the different bars.\n\n**Disadvantages:** Not the most exciting graph in the world.\n\n# Stacked Bar Chart\n\nWe make a simple change to the bar chart to produce a stacked bar chart.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(data = mydata,\n       aes(x = 1, # x is 1 for everyone\n           fill = group)) + # fill is the group\n  geom_bar() + # draw with bars\n  labs(title = \"A Stacked Bar Chart\") + # labels\n  scale_fill_viridis_d() + # pretty colors\n  theme_minimal() # minimal theme\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Grammar of Graphics\n\nNow the bars are not distributed along the *x axis*, but stacked on top of each other.\n\nThe *y axis* still represents the *count* of *group*.\n\nBut now the *x axis* in this graph does not really provide much information, and only *color* of the graph tells us about the group\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"grViz html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-ca6209f1238639298e3c\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ca6209f1238639298e3c\">{\"x\":{\"diagram\":\"\\n\\ndigraph {\\n\\ngraph [layout = dot,\\n       rankdir = RL]\\n\\n# node definitions with substituted label text\\nnode [fontname = Helvetica]\\n\\ng [label = \\\"graph\\\"]\\nx [label = \\\"x axis\\\"]\\ny [label = \\\"y axis\\\"]\\n\\n# edge definitions with the node IDs\\n\\nx -> g\\ny -> g\\ncolor -> g\\ncount -> y\\ngroup -> color\\n\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Advantages and Disadvantages\n\n**Advantages:**  Looks different than a traditional bar chart. The stacking of the bars may give us a sense of the *relative* contribution of each group to the *overall total*.\n\n**Disadvantages:** We can no longer *directly* compare the height of the bars. This chart may therefore be difficult to interpret in some cases.\n\n# Pie Chart\n\nA pie chart is just this *stacked* bar chart transformed (or *wrapped* into a circle) by using *polar coordinates*:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(data = mydata,\n       aes(x = 1, # x is 1 for everyone\n           fill = group)) + # fill is also the group\n  geom_bar() + # draw with bars\n  labs(title = \"A Pie Chart\") + # labels\n  coord_polar(theta = \"y\")  + # polar coordinates\n  scale_fill_viridis_d() + # pretty colors\n  theme_void() # void theme\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Grammar of Graphics\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"grViz html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-0cc1deec7ac180e13c6f\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0cc1deec7ac180e13c6f\">{\"x\":{\"diagram\":\"\\n\\ndigraph {\\n\\ngraph [layout = dot,\\n       rankdir = RL]\\n\\n# node definitions with substituted label text\\nnode [fontname = Helvetica]\\n\\ng [label = \\\"graph\\\"]\\nx [label = \\\"x axis\\\"]\\ny [label = \\\"y axis\\\"]\\np [label = \\\"polar coordinates\\\"]\\n\\n# edge definitions with the node IDs\\n\\nx -> g\\ny -> g\\ncolor -> g\\ncount -> y\\ngroup -> color\\np -> y\\np -> x\\n\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Advantages and Disadvantages\n\n**Advantages:**  Despite the invective directed at pie charts, pie charts may also have the advantage of looking different than a traditional bar chart. The circular arrangement of the pie slices may give us a sense of the *relative* contribution of each group to the *overall total*.\n\n**Disadvantages:** We can no longer *directly* compare the height of the bars. Angles of pie slices may be more difficult to interpret than heights of bars, particularly when there are many slices. *Labels* may be difficult to add to pie charts, particularly in `ggplot`.\n\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/viz-1.8.2/viz.js\"></script>\n<link href=\"../../site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/grViz-binding-1.0.9/grViz.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}