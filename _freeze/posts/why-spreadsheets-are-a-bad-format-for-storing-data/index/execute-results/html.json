{
  "hash": "990942c5fb021c8ab9cce15d2ff88ecf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Why Spreadsheets Are A Bad Format For Storing Data\"\nauthor: \"Andy Grogan-Kaylor\"\ndate: \"2025-9-22\"\ncategories: [stats, workflow]\n---\n\n# Background\n\nExcel and Google Sheets are sometimes used as programs to collect and store data. Excel and Google Sheets are often used because they are the only programs that some individuals or agencies have for storing data. Additionally, many programs like Qualtrics or RedCap may use Excel as a default output format. \n\nExcel and other spreadsheet programs may also be used because spreadsheets can be very intuitive and easy ways of managing small amounts of data. \n\nHowever, Excel and Google Sheets may be problematic as a data storage solution for a number of reasons detailed below, especially as data sets grow in size. Notably, statistical programs like [Stata](https://www.stata.com/), [SAS](https://www.sas.com/en_us/home.html), or SPSS all store additional information with each variable such as: a *variable label*, describing the contents of the variable, or the survey question that resulted in the variable; and a *value label*, which attaches qualitative information to each possible value of the response.[^CSV]\n\n[^CSV]: Over time, I've realized that the issues discussed in this post also apply to the use of CSV (comma separated value) files. While CSV files are convenient, and can be imported by almost any software, they may lead to many of the same issues discussed in this post.\n\nExcel and Google Sheets do not generally contain this extra information about each variable, or column of data, which may lead to extra work, extra effort, or even errors in working with quantitative information.\n\nThe data below are stored in Stata format, but could as easily be stored in SAS or SPSS format.\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n# Get And Describe The Data\n\n![Screenshot of Data in Stata](screenshot-Stata.png){ width=75% } \n\n\n::: {.cell collectcode='true'}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data.dta\", clear\n\ndescribe\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\nContains data from simulated-happiness-data.dta\n Observations:           100                  \n    Variables:             2                  23 Sep 2025 11:18\n-------------------------------------------------------------------------------------\nVariable      Storage   Display    Value\n    name         type    format    label      Variable label\n-------------------------------------------------------------------------------------\nid              float   %9.0g                 id\nQ1              float   %9.0g      Likert1    How often do you feel happy?\n-------------------------------------------------------------------------------------\nSorted by: \n```\n\n\n:::\n:::\n\n\n# Descriptive Statistics and Bar Graph\n\n::: {.callout-tip}\n## The Descriptive Statistics And Graph Are Informative\n\nNotice how the descriptive statistics and graph are *informative* in that they contain information on the *variable label* and *value label*. These help us to get an intuitive sense of the information in the data. We see this information when we list out the data as well.\n:::\n\n## Descriptive Statistics\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data.dta\", clear\n\ntabulate Q1\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  How often |\ndo you feel |\n     happy? |      Freq.     Percent        Cum.\n------------+-----------------------------------\n      Never |         21       21.00       21.00\n     Rarely |         29       29.00       50.00\n  Sometimes |         28       28.00       78.00\n      Often |         22       22.00      100.00\n------------+-----------------------------------\n      Total |        100      100.00\n```\n\n\n:::\n:::\n\n\n## Bar Graph\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data.dta\", clear\n\ngraph bar, over(Q1) title(\"How often do you feel happy?\") asyvars\n\t\ngraph export mybar1.png, width(1500) replace\n\n```\n:::\n\n\n![Bar Graph](mybar1.png){width=50%}\n\n## List Out A Sample Of The Data\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data.dta\", clear\n\nlist in 1/10\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     | id          Q1 |\n     |----------------|\n  1. |  1       Never |\n  2. |  2   Sometimes |\n  3. |  3       Never |\n  4. |  4   Sometimes |\n  5. |  5   Sometimes |\n     |----------------|\n  6. |  6       Often |\n  7. |  7      Rarely |\n  8. |  8   Sometimes |\n  9. |  9       Never |\n 10. | 10      Rarely |\n     +----------------+\n```\n\n\n:::\n:::\n\n\n# Now Use The Data In Excel Format\n\n::: {.callout-tip}\n## Spreadsheets Are All Similar\n\nThe example below focuses on Excel, but could as easily apply to a program like Google Sheets.\n:::\n\n\n::: {.cell}\n\n:::\n\n\nI've saved this simulated data in Excel format.\n\n![Screenshot of Data in Excel Format](screenshot-Excel.png){ width=75% } \n\nI now import the Excel data file. I use the first row of data as variable names.\n\n\n::: {.cell collectcode='true'}\n\n:::\n\n\n::: {.callout-tip}\n## Spreadsheet Data Are Less Informative\n\nWe see right away--when we list some of the data--that the data are less informative. \n:::\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data-EXCEL.dta\", clear\n\nlist in 1/10\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     | id   Q1 |\n     |---------|\n  1. |  1    1 |\n  2. |  2    3 |\n  3. |  3    1 |\n  4. |  4    3 |\n  5. |  5    3 |\n     |---------|\n  6. |  6    4 |\n  7. |  7    2 |\n  8. |  8    3 |\n  9. |  9    1 |\n 10. | 10    2 |\n     +---------+\n```\n\n\n:::\n:::\n\n\n::: {.callout-tip}\n## Statistical Formats Save Work and Reduce Error Rates\n\nAdding this valuable information back into the data set may take a great deal of extra effort, and may also lead to errors.\n:::\n\n# Descriptive Statistics and Bar Graph\n\nNotice how the descriptive statistics and graph are much less informative. For example, it is now not immediately clear what `Q1` represents. \n\nIt is also not clear whether higher values of `Q1` represent higher levels of *happiness*, or higher levels of *unhappiness*, a crucially important substantive distinction. The information on variable label and value label will have to be added back into the data when preparing a report for dissemination. \n\nIf there are several, or many, variables in the data set, this step of adding information back into the data will have to be done multiple times, increasing the time for data processing, as well as introducing a possibility for error.\n\n## Descriptive Statistics\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data-EXCEL.dta\", clear\n\ntabulate Q1\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         Q1 |      Freq.     Percent        Cum.\n------------+-----------------------------------\n          1 |         21       21.00       21.00\n          2 |         29       29.00       50.00\n          3 |         28       28.00       78.00\n          4 |         22       22.00      100.00\n------------+-----------------------------------\n      Total |        100      100.00\n```\n\n\n:::\n:::\n\n\n### Bar Graph\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nuse \"simulated-happiness-data-EXCEL.dta\", clear\n\ngraph bar, over(Q1) title(\"How often do you feel happy?\") asyvars\n\t\ngraph export mybar2.png, width(1500) replace\n\n```\n:::\n\n\n![Bar Graph](mybar2.png){width=50%}\n\n# A Few Final Issues\n\nNotice how Excel doesn't enforce the idea of whether variables are *numeric*, or *string*, and so would allow storage of different types of information in the same column. Relatedly, *numeric* variables may be improperly stored as *strings*, often necessitating recoding before graphical or statistical procedures can be employed.\n\nExcel also doesn't enforce the idea that data in the same row belong to the same individual, making it easily to accidentally move, or write over, data.\n\nLastly, Excel would allow some of your columns to have the same name, which might make data difficult to work with in other software.\n\n| x           | y           | verylongvariablename | verylongvariablename | verylongvariablename |\n| ----------- | ----------- |--------------------- | -------------------- | -------------------- |\n| 100         | 1           | Smith                | 20                   | 30                   |\n| 200         | 2           | 30                   | NA                   | 40                   |\n| not applicable   | x      | yes                  | 60                   | 50                   |\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}